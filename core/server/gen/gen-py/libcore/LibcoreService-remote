#!/usr/bin/env python
#
# Autogenerated by Thrift Compiler (0.22.0)
#
# DO NOT EDIT UNLESS YOU ARE SURE THAT YOU KNOW WHAT YOU ARE DOING
#
#  options string: py
#

import sys
import pprint
if sys.version_info[0] > 2:
    from urllib.parse import urlparse
else:
    from urlparse import urlparse
from thrift.transport import TTransport, TSocket, TSSLSocket, THttpClient
from thrift.protocol.TBinaryProtocol import TBinaryProtocol

from libcore import LibcoreService
from libcore.ttypes import *

if len(sys.argv) <= 1 or sys.argv[1] == '--help':
    print('')
    print('Usage: ' + sys.argv[0] + ' [-h host[:port]] [-u url] [-f[ramed]] [-s[sl]] [-novalidate] [-ca_certs certs] [-keyfile keyfile] [-certfile certfile] function [arg1 [arg2...]]')
    print('')
    print('Functions:')
    print('  ErrorResp Start(LoadConfigReq req)')
    print('  ErrorResp Stop(EmptyReq req)')
    print('  ErrorResp CheckConfig(LoadConfigReq req)')
    print('  TestResp Test(TestReq req)')
    print('  EmptyResp StopTest(EmptyReq req)')
    print('  QueryURLTestResponse QueryURLTest(EmptyReq req)')
    print('  QueryStatsResp QueryStats(EmptyReq req)')
    print('  ListConnectionsResp ListConnections(EmptyReq req)')
    print('  EmptyResp SetSystemDNS(SetSystemDNSRequest req)')
    print('  IsPrivilegedResponse IsPrivileged(EmptyReq req)')
    print('  SpeedTestResponse SpeedTest(SpeedTestRequest req)')
    print('  QuerySpeedTestResponse QuerySpeedTest(EmptyReq req)')
    print('  QueryCountryTestResponse QueryCountryTest(EmptyReq req)')
    print('')
    sys.exit(0)

pp = pprint.PrettyPrinter(indent=2)
host = 'localhost'
port = 9090
uri = ''
framed = False
ssl = False
validate = True
ca_certs = None
keyfile = None
certfile = None
http = False
argi = 1

if sys.argv[argi] == '-h':
    parts = sys.argv[argi + 1].split(':')
    host = parts[0]
    if len(parts) > 1:
        port = int(parts[1])
    argi += 2

if sys.argv[argi] == '-u':
    url = urlparse(sys.argv[argi + 1])
    parts = url[1].split(':')
    host = parts[0]
    if len(parts) > 1:
        port = int(parts[1])
    else:
        port = 80
    uri = url[2]
    if url[4]:
        uri += '?%s' % url[4]
    http = True
    argi += 2

if sys.argv[argi] == '-f' or sys.argv[argi] == '-framed':
    framed = True
    argi += 1

if sys.argv[argi] == '-s' or sys.argv[argi] == '-ssl':
    ssl = True
    argi += 1

if sys.argv[argi] == '-novalidate':
    validate = False
    argi += 1

if sys.argv[argi] == '-ca_certs':
    ca_certs = sys.argv[argi+1]
    argi += 2

if sys.argv[argi] == '-keyfile':
    keyfile = sys.argv[argi+1]
    argi += 2

if sys.argv[argi] == '-certfile':
    certfile = sys.argv[argi+1]
    argi += 2

cmd = sys.argv[argi]
args = sys.argv[argi + 1:]

if http:
    transport = THttpClient.THttpClient(host, port, uri)
else:
    if ssl:
        socket = TSSLSocket.TSSLSocket(host, port, validate=validate, ca_certs=ca_certs, keyfile=keyfile, certfile=certfile)
    else:
        socket = TSocket.TSocket(host, port)
    if framed:
        transport = TTransport.TFramedTransport(socket)
    else:
        transport = TTransport.TBufferedTransport(socket)
protocol = TBinaryProtocol(transport)
client = LibcoreService.Client(protocol)
transport.open()

if cmd == 'Start':
    if len(args) != 1:
        print('Start requires 1 args')
        sys.exit(1)
    pp.pprint(client.Start(eval(args[0]),))

elif cmd == 'Stop':
    if len(args) != 1:
        print('Stop requires 1 args')
        sys.exit(1)
    pp.pprint(client.Stop(eval(args[0]),))

elif cmd == 'CheckConfig':
    if len(args) != 1:
        print('CheckConfig requires 1 args')
        sys.exit(1)
    pp.pprint(client.CheckConfig(eval(args[0]),))

elif cmd == 'Test':
    if len(args) != 1:
        print('Test requires 1 args')
        sys.exit(1)
    pp.pprint(client.Test(eval(args[0]),))

elif cmd == 'StopTest':
    if len(args) != 1:
        print('StopTest requires 1 args')
        sys.exit(1)
    pp.pprint(client.StopTest(eval(args[0]),))

elif cmd == 'QueryURLTest':
    if len(args) != 1:
        print('QueryURLTest requires 1 args')
        sys.exit(1)
    pp.pprint(client.QueryURLTest(eval(args[0]),))

elif cmd == 'QueryStats':
    if len(args) != 1:
        print('QueryStats requires 1 args')
        sys.exit(1)
    pp.pprint(client.QueryStats(eval(args[0]),))

elif cmd == 'ListConnections':
    if len(args) != 1:
        print('ListConnections requires 1 args')
        sys.exit(1)
    pp.pprint(client.ListConnections(eval(args[0]),))

elif cmd == 'SetSystemDNS':
    if len(args) != 1:
        print('SetSystemDNS requires 1 args')
        sys.exit(1)
    pp.pprint(client.SetSystemDNS(eval(args[0]),))

elif cmd == 'IsPrivileged':
    if len(args) != 1:
        print('IsPrivileged requires 1 args')
        sys.exit(1)
    pp.pprint(client.IsPrivileged(eval(args[0]),))

elif cmd == 'SpeedTest':
    if len(args) != 1:
        print('SpeedTest requires 1 args')
        sys.exit(1)
    pp.pprint(client.SpeedTest(eval(args[0]),))

elif cmd == 'QuerySpeedTest':
    if len(args) != 1:
        print('QuerySpeedTest requires 1 args')
        sys.exit(1)
    pp.pprint(client.QuerySpeedTest(eval(args[0]),))

elif cmd == 'QueryCountryTest':
    if len(args) != 1:
        print('QueryCountryTest requires 1 args')
        sys.exit(1)
    pp.pprint(client.QueryCountryTest(eval(args[0]),))

else:
    print('Unrecognized method %s' % cmd)
    sys.exit(1)

transport.close()
